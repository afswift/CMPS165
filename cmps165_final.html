<!DOCTYPE html>
<meta charset="utf-8">
<style>
    
body {
    background-color: #ffffff;
}
	
.country {
    fill: #fff;
    stroke: #fff;
    stroke-width: .5px;
    stroke-linejoin: round;
}

.graticule {
    fill: none;
    stroke: #000;
    stroke-opacity: .3;
    stroke-width: .5px;
}

.graticule.outline {
    stroke: #333;
    stroke-opacity: 1;
    stroke-width: 1.5px;
}
	
div.tooltip {	
    position: absolute;
    width: 190px;
    height: auto;
    padding: 10px;
    font-size: 12px;
	font-family: "Trebuchet MS";
    background-color: white;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 10px;
    -webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
    -moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
    box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
    pointer-events: none;		
}
    
.legend {
  font-size: 12px;
}
    
.q0-9 { fill:rgb(247,251,255); }
.q1-9 { fill:rgb(222,235,247); }
.q2-9 { fill:rgb(198,219,239); }
.q3-9 { fill:rgb(158,202,225); }
.q4-9 { fill:rgb(107,174,214); }
.q5-9 { fill:rgb(66,146,198); }
.q6-9 { fill:rgb(33,113,181); }
.q7-9 { fill:rgb(8,81,156); }
.q8-9 { fill:rgb(8,48,107); }
	


.PovertyButton {
	height: auto;
	width: 200px;
	height: 63px;
	background: #dddddd;
	border:1px solid #000000;
		border-left-style: none;
	border-right-style: none;
	display:inline-block;
	cursor:pointer;
	color:#000000;
	font-family:arial;
	font-size:19px;
	padding:7px 19px;

}

.PovertyButton:hover {
  background: #f8f8f8;
  text-decoration: none;
}

	area1 {	
		float:left;
	}

	area2 {
		background-color:black;
		float:right;
	}
	

    
</style>

<body>
<h1 style = "text-align:center; color:steelblue; font-family:verdana "><bold> Global Waste </bold></h1>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/d3.geo.projection.v0.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script src="d3-zoom-pan-extent.js"></script>
	<center>
	<div id="area1"></div>
	<div id="area2"></div>
		</center>
<script>
 
	
	
var width = 960,
    height = 504;
    
var x = d3.scale.linear()
    .domain([-width / 2, width / 2])
    .range([0, width]);

var y = d3.scale.linear()
    .domain([-height / 2, height / 2])
    .range([height, 0]);

var projection = d3.geo.equirectangular()
        .scale(150)
        .translate([width / 2, height / 2]),
    color = d3.scale.category20(),
    graticule = d3.geo.graticule();

var path = d3.geo.path()
    .projection(projection);
    
var zoom = d3.behavior.zoom()
    .x(x)
    .xExtent([(-width  / 2) - 3.2, (-width  / 2) + 3.2])
    .y(y)
    .yExtent([(height / 2) - 1.667, (height / 2) + 1.667])
    .translate(projection.translate())
    .scale(projection.scale())
    .scaleExtent([150, 10000]) 
    .on("zoom", zoomed);
    
function clicked(d) {
    var centroid = path.centroid(d),
        translate = projection.translate();

    projection.translate([
            translate[0] - centroid[0] + width / 2,
            translate[1] - centroid[1] + height / 2
    ]);
    zoom.translate(projection.translate());

    g.selectAll("path").transition()
          .duration(700)
          .attr("d", path);
}
    
function zoomed() {
    projection.translate(d3.event.translate).scale(d3.event.scale);
    g.selectAll("path").attr("d", path);
}

var svg = d3.select("#area1").append("svg")
    .attr("width", width)
    .attr("height", height);

var g = svg.append("g")
	.call(zoom)

var div = d3.select("body").append("div")   
    .attr("class", "tooltip")               
    .style("opacity", 0);	
	
	var play = svg.append("g")
    .attr("class", "play");



/*
svg.append("path")
    .datum(graticule)
    .attr("class", "graticule")
    .attr("d", path);
*/
    
g.append("rect")
    .attr("width", width)
    .attr("height", height)
	.attr("fill", "#eee");
    

/* this code puts a border around the map    
svg.append("path")
    .datum(graticule.outline)
    .attr("class", "graticule outline")
    .attr("d", path);
*/

var quantize = d3.scale.quantize()
    .domain([0, 3])
    .range(d3.range(9).map(function(i) { return "q" + i + "-9"; }));
    
// legend
var color_domain = [50, 150, 350, 750, 1500, 2000, 4000, 8000] // to corrolate with the 
var ext_color_domain = [0, 50, 150, 350, 750, 1500, 2000, 4000, 8000]
var legend_labels = ["< 50", "50+", "150+", "350+", "750+", "1500+", "2000+","4000+","8000+"]   // labelling for the variables      
var color = d3.scale.threshold()
    .domain(color_domain)
    .range(["#F7FBFF","#DEEBF7","#C6DBEF", "#9ECAE1", "#6BAED6", "#4292C6", "#2171B5", "#08519C", "#08306B"]); //colors to show on legend
    

var legend = svg.selectAll("g.legend")
    .data(ext_color_domain)
    .enter().append("g")
    .attr("class", "legend");

var ls_w = 20, ls_h = 20;

legend.append("rect")
      .attr("x", 20)
      .attr("y", function(d, i){ return height - (i*ls_h) - 2*ls_h;})
      .attr("width", ls_w)
      .attr("height", ls_h)
      .style("fill", function(d, i) { return color(d); })
    //.style("opacity", 0.8);

legend.append("text")  
     .attr("x", 50)
     .attr("y", function(d, i){ return height - (i*ls_h) - ls_h - 4;})
     .text(function(d, i){ return legend_labels[i]; });
    

    
d3.json("final.json", function(error, world) {
     var countries = topojson.feature(world, world.objects.countries).features;
		//console.log(data);
     g.selectAll(".country")
        .data(countries)
        .enter().insert("path", ".graticule")
        .attr("class", "country")
        .attr("d", path)
        .on("click", clicked)
     
        .on("mouseover", function(d, i, test) {
            div.transition()        
                .duration(200)      
                .style("opacity", .9);
		 
            div .html(				
                    "<div style=\"text-align:center\">" +"<b>" +  d.id + "</b>" +  "</div>" +
                    "<div style=\"float: left\">" + "Population: " + "</div>" +  "<div style=\"float:right\">" + d.properties.population + "</div>" + "<br/>" +
                    "<div style=\"float: left\">" + "Waste: " + "</div>" +  "<div style=\"float:right\">" + d.properties.waste + " Tonnes/Day" +  "</div>" +"<br/>"  +
                    "<div style=\"float: left\">" + "WPC: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.wpc   +" Kg/Capita/Day"+  "</div>" +"<br/>"  +	 
                    "<div style=\"float: left\">" +"Organic: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.organic  + "%" + "</div>" +"<br/>"  +
                    "<div style=\"float: left\">" +"Paper: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.paper  + "%"+ "</div>" + "<br/>"  +
                    "<div style=\"float: left\">" + "Plastic: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.plastic  + "%"+ "</div>" + "<br/>"  +
                    "<div style=\"float: left\">" + "Glass: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.glass  + "%"+ "</div>" + "<br/>"  + 
                    "<div style=\"float: left\">" + "Metal: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.metal  + "%"+ "</div>" + "<br/>"  +
                    "<div style=\"float: left\">" + "Other: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.other + "%" +  "</div>"
                 )  
                .style("left", (d3.event.pageX) + "px")     
                .style("top", (d3.event.pageY - 28) + "px");
		 
        })          
     
        .on("mouseout", function(d) {
            div .transition()		
                .duration(500)		
                .style("opacity", 0);	
        })     
        .attr("class", function(d) { return quantize(d.properties.wpc); });
    })
    
function Organic(){
    
    var quantizeOrganic = d3.scale.quantize()
        .domain([0, 100])
        .range(d3.range(9).map(function(i) { return "q" + i + "-9"; }));
    
    var svg = d3.select("body").transition();
    
    d3.json("final.json", function(error, world) {
     var countries = topojson.feature(world, world.objects.countries).features;
		//console.log(data);
     g.selectAll(".country")
        .data(countries)
        .enter().insert("path", ".graticule")
        .attr("class", "country")
        .attr("d", path)
        .on("click", clicked)
     
        .on("mouseover", function(d, i, test) {
            div.transition()        
                .duration(200)      
                .style("opacity", .9);
		 
            div .html(				
                    "<div style=\"text-align:center\">" +"<b>" +  d.id + "</b>" +  "</div>" +
                    "<div style=\"float: left\">" + "Population: " + "</div>" +  "<div style=\"float:right\">" + d.properties.population + "</div>" + "<br/>" +
                    "<div style=\"float: left\">" + "Waste: " + "</div>" +  "<div style=\"float:right\">" + d.properties.waste + " Tonnes/Day" +  "</div>" +"<br/>"  +
                    "<div style=\"float: left\">" + "WPC: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.wpc   +" Kg/Capita/Day"+  "</div>" +"<br/>"  +	 
                    "<div style=\"float: left\">" +"Organic: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.organic  + "%" + "</div>" +"<br/>"  +
                    "<div style=\"float: left\">" +"Paper: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.paper  + "%"+ "</div>" + "<br/>"  +
                    "<div style=\"float: left\">" + "Plastic: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.plastic  + "%"+ "</div>" + "<br/>"  +
                    "<div style=\"float: left\">" + "Glass: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.glass  + "%"+ "</div>" + "<br/>"  + 
                    "<div style=\"float: left\">" + "Metal: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.metal  + "%"+ "</div>" + "<br/>"  +
                    "<div style=\"float: left\">" + "Other: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.other + "%" +  "</div>"
                 )  
                .style("left", (d3.event.pageX) + "px")     
                .style("top", (d3.event.pageY - 28) + "px");
		 
        })          
     
        .on("mouseout", function(d) {
            div .transition()		
                .duration(500)		
                .style("opacity", 0);	
        })     
        .attr("class", function(d) { return quantizeOrganic(d.properties.organic); });
    })

    
}


function WPC(){
    
    var svg = d3.select("body").transition();
    
    d3.json("final.json", function(error, world) {
     var countries = topojson.feature(world, world.objects.countries).features;
		//console.log(data);
     g.selectAll(".country")
        .data(countries)
        .enter().insert("path", ".graticule")
        .attr("class", "country")
        .attr("d", path)
        .on("click", clicked)
     
        .on("mouseover", function(d, i, test) {
            div.transition()        
                .duration(200)      
                .style("opacity", .9);
		 
            div .html(				
                    "<div style=\"text-align:center\">" +"<b>" +  d.id + "</b>" +  "</div>" +
                    "<div style=\"float: left\">" + "Population: " + "</div>" +  "<div style=\"float:right\">" + d.properties.population + "</div>" + "<br/>" +
                    "<div style=\"float: left\">" + "Waste: " + "</div>" +  "<div style=\"float:right\">" + d.properties.waste + " Tonnes/Day" +  "</div>" +"<br/>"  +
                    "<div style=\"float: left\">" + "WPC: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.wpc   +" Kg/Capita/Day"+  "</div>" +"<br/>"  +	 
                    "<div style=\"float: left\">" +"Organic: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.organic  + "%" + "</div>" +"<br/>"  +
                    "<div style=\"float: left\">" +"Paper: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.paper  + "%"+ "</div>" + "<br/>"  +
                    "<div style=\"float: left\">" + "Plastic: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.plastic  + "%"+ "</div>" + "<br/>"  +
                    "<div style=\"float: left\">" + "Glass: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.glass  + "%"+ "</div>" + "<br/>"  + 
                    "<div style=\"float: left\">" + "Metal: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.metal  + "%"+ "</div>" + "<br/>"  +
                    "<div style=\"float: left\">" + "Other: "+ "</div>" +  "<div style=\"float:right\">" + d.properties.other + "%" +  "</div>"
                 )  
                .style("left", (d3.event.pageX) + "px")     
                .style("top", (d3.event.pageY - 28) + "px");
		 
        })          
     
        .on("mouseout", function(d) {
            div .transition()		
                .duration(500)		
                .style("opacity", 0);	
        })     
        .attr("class", function(d) { return quantize(d.properties.wpc); });
    })

    
}

</script>
	
	<p style="width: 1200px;">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras eros nibh, tincidunt id dolor ut, pulvinar suscipit augue. Nulla finibus facilisis sem efficitur gravida. Nulla lorem neque, finibus vitae magna in, blandit scelerisque erat. In hac habitasse platea dictumst. Ut pretium, libero eu rutrum vulputate, orci elit vulputate diam, a placerat ipsum libero ut quam. Nullam eget laoreet velit. Cras ullamcorper erat id odio dictum elementum. Nam rhoncus mauris at vehicula ornare. Aliquam ac nunc tortor. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Aenean facilisis purus ligula, vitae vulputate nisl dapibus ac. Nulla at ultricies urna. Phasellus tortor risus, tristique non scelerisque volutpat, luctus vel metus. Nulla ante ante, sollicitudin in sem eget, semper dapibus leo. In euismod, diam nec convallis consectetur, ex elit accumsan odio, in consequat nisl mauris eu lorem. Quisque purus dui, elementum rutrum efficitur ut, sodales sed massa. </p>
	
	<h4>Created for CMPS 165: Data Programming for Visualization, Spring 2016</h4>
    <h4>Created By:</h4>    
    <ul>
      <li>Alexander Swift</li>
      <li>Aramis Marden</li>
      <li>Chloe Jiang</li>
      <li>Zach Holbrook</li>
    </ul>
	
    <h4>In collaboration with Suresh K. Lodha, and V Karthik Thota </h4>    
    
	<h4>Data Sources:</h4>
	<ul>
        <li><a href="https://github.com/afswift/CMPS165" target = "_blank">My Github</a></li>
		<li><a href="http://siteresources.worldbank.org/INTURBANDEVELOPMENT/Resources/336387-1334852610766/What_a_Waste2012_Final.pdf" target = "_blank">World Waste Statistics 2012</a></li>
	</ul>

    <h4>Code Sources:</h4>
	<ul>
        <li><a href="http://bl.ocks.org/rveciana/f46df2272b289a9ce4e7" target = "_blank"> World JSON map</a></li>
		<li><a href="https://github.com/ryanbrounley/LAvsSF" target = "_blank"> Ryan Brounley's LAvsSF GitHub</a></li>
	</ul>
	
	<center></center>
	<ul style="list-style-type: none; text-align: center;position: relative; left: 560px; top: -1052px;" >
       <li><button id="Population" class="PovertyButton" onclick="Population();">Waste</button></li>
	   <li><button id="Housing Prices" class="PovertyButton" onclick="WPC();">Waste Per Capita</button></li>
	   <li><button id="Income" class="PovertyButton" onclick="Organic();">Organic</button></li>
       <li><button id="Employment" class="PovertyButton" onclick="Employment();">Paper</button></li>
       <li><button id="Poverty" class="PovertyButton" onclick="Plastic();">Plastic</button></li>
	   <li><button id="Poverty" class="PovertyButton" onclick="Glass();">Glass</button></li>
	   <li><button id="Poverty" class="PovertyButton" onclick="Metal();">Metal</button></li>
       <li><button id="Poverty" class="PovertyButton" onclick="Other();">Other</button></li>
	
	</ul>
</center>